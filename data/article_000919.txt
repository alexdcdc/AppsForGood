The Team Sky rider made a late attack in the 180km stage to finish just in front of team-mate Mikel Landa, who won the 2016 Tour.
Thomas is now 16 seconds ahead of the rest of the field with two days of the Tour remaining.
The 31-year-old will be leading Team Sky for the first time in the three week-long Giro d'Italia next month.